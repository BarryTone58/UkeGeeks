/**
 * This library implments the UkeGeeks Scriptasaurus Song-a-matic editor functions, bridging the page UI and scriptasaurus methods.
 * @module  ugsEditorPlus
 * @namespace  ugsEditorPlus
 * @class ugsEditorPlus
 */
var ugsEditorPlus = (function() {
	/**
	 * attach public members to this object
	 * @property _public
	 * @type JsonObject
	 */
	var _public = {};

	/**
	 * attaches event handlers, preps variables, and runs UGS
	 * @method init
	 * @private
	 * @param isLegacyIe {bool} pre-IE 9 versions
	 */
	var init = function(isLegacyIe) {
		// ukeGeeks.tumblr.opts.diagramResizeTo = 1;
		ukeGeeks.settings.opts.retainBrackets = false;

		ukeGeeks.scriptasaurus.init(isLegacyIe);

		ugsEditorPlus.actions.init(isLegacyIe);
		ugsEditorPlus.topMenus.init();
		ugsEditorPlus.submenuUi.init(ugsEditorPlus.actions.doAction);
		ugsEditorPlus.optionsDlg.init(ugsEditorPlus.actions.doAction);
		ugsEditorPlus.chordBuilder.init();
		ugsEditorPlus.actions.run();
	};

	/**
	 * wraps the private Init method for modern browsers
	 * @method attach
	 * @public
	 */
	_public.attach = function() {
		init(false);
	};

	/**
	 * wraps the private Init method, required for Legacy Internet Exploere (pre-9)
	 * @method attach
	 * @public
	 */
	_public.attachIe = function() {
		init(true);
	};

	// ---------------------------------------
	// return public interface "JSON handle"
	// ---------------------------------------
	return _public;

}());
;ugsEditorPlus.actions=function(){var a={},c={},b=null,h=null,k=[],d=/^([A-G][#b]?)(m|m6|7|m7|dim|maj7|6|sus2|sus4|aug|9)?$/,l={placement:"above",transpose:"up_0"};a.init=function(b){c={songText:document.getElementById("ukeSongText"),songContainer:document.getElementById("ukeSongContainer"),cpmSource:document.getElementById("chordProSource"),scalableArea:document.getElementById("scalablePrintArea")}};a.doAction=function(b,p){switch(b){case "zoomFonts":var q=parseFloat(p,10);c.scalableArea.style.fontSize=
q+"pt";break;case "zoomDiagrams":var q=parseInt(p,10)/100,m=Math.round(225*q),f=ugsEditorPlus.styles.getSheet("ugsEditorCss"),g=f.Find(".scalablePrintArea .ugs-diagrams-wrap canvas");g.style.width=Math.round(q*ukeGeeks.settings.fretBox.width)+"px";g.style.height=Math.round(q*ukeGeeks.settings.fretBox.height)+"px";g=f.Find(".scalablePrintArea .ugs-diagrams-wrap");g.style.width=m+"px";g=f.Find(".scalablePrintArea .ugs-source-wrap");g.style.marginLeft=25+m+"px";break;case "layout":$("body").toggleClass("diagramsOnTop",
"top"==p).toggleClass("diagramsOnSide","left"==p).toggleClass("ugsHideDiagrams","none"==p);break;case "placement":ukeGeeks.toolsLite.setClass(c.songContainer,"ugsInline","inline"==p);(q="miniDiagrams"==p)||ukeGeeks.toolsLite.removeClass(c.songContainer,"ugsInlineDiagrams");q||"miniDiagrams"==l.placement?(ukeGeeks.settings.inlineDiagrams=q,a.run()):q||"miniDiagrams"==l.placement||ukeGeeks.overlapFixer.Fix(c.songText);l.placement=p;break;case "tuning":q=ukeGeeks.definitions.instrument.sopranoUke;m=
"Standard <strong>GCEA</strong> Soprano Ukulele";"baritone"==p&&(q=ukeGeeks.definitions.instrument.baritoneUke,m="Standard <strong>DGBE</strong> Baritone Ukulele");$("#footTuningInfo").html(m);ukeGeeks.scriptasaurus.setTuningOffset(q);a.run();break;case "colors":ugsEditorPlus.themes.set(p);a.run();break;case "transpose":q="u"==p[0]?1:-1;m=parseInt(p[p.length-1],10);var q=q*m,g=[],m="",e;for(e=0;e<k.length;e++)d.test(k[e])?g.push(k[e]):m+=k[e]+", ";if(!(0<m.length)||confirm("Sorry, but some of your chords can't be transposed:\n"+
m+"\n\nDo you want to continue anyway?")){var r=ukeGeeks.transpose.shiftChords(g,q),m=h;for(e=0;e<g.length;e++)f=RegExp("\\["+g[e]+"\\]","g"),m=m.replace(f,"[ugsxx_"+e+"]");for(e=0;e<r.length;e++)f=RegExp("\\[ugsxx_"+e+"\\]","g"),m=m.replace(f,"["+r[e]+"]");f=/^\s*\{\s*(key|k)\s*:\s*(\S*?)\s*\}\s*$/im;f.test(m)&&(g=m.match(f),e=g[2],""!==e&&d.test(e)&&(m=m.replace(f,g[0].replace(e,ukeGeeks.transpose.shift(e,q)))));c.cpmSource.value=m;a.run()}break;case "paper":q=["letter","a4","screen"];m=$("body");
for(f=0;f<q.length;f++)m.removeClass("pageWidth_"+q[f]);m.addClass("pageWidth_"+p);break;case "showEnclosures":ukeGeeks.settings.opts.retainBrackets=p;a.run();break;case "hideCommonChords":ukeGeeks.settings.opts.ignoreCommonChords=p;a.run();break;case "setCommonChords":q=p.split(/[ ,]+/);m=[];for(f=0;f<q.length;f++)g=ukeGeeks.toolsLite.trim(q[f]),0<g.length&&m.push(g);ukeGeeks.settings.commonChords=m;ukeGeeks.settings.opts.ignoreCommonChords&&a.run();break;case "update":a.run(!0);break;default:console.log("Unrecognized "+
b+" > "+p)}};a.run=function(d){d=0<arguments.length&&d;c.songText.innerHTML="<pre>"+c.cpmSource.value+"</pre>";b=ukeGeeks.scriptasaurus.run();1>b.chords.length&&ugsEditorPlus.autoReformat.run(c);if(b&&(ugsEditorPlus.songUi.update(b),d||null===h)){h=c.cpmSource.value;k=b.chords;var a=""!==b.key?b.key:1>b.chords.length?"":b.chords[0],q=document.getElementById("transposeOptions").getElementsByTagName("li"),m,f=-6;l.transpose="up_0";ugsEditorPlus.submenuUi.resetTransposeLabel();for(var g=0;g<q.length;g++)ukeGeeks.toolsLite.removeClass(q[g],
"checked"),m=1>a.length?"":ukeGeeks.transpose.shift(a,f),q[g].getElementsByTagName("em")[0].innerHTML=m,0===f&&ukeGeeks.toolsLite.addClass(q[g],"checked"),f++}};return a}();
ugsEditorPlus.songUi=function(){var a={},c=function(b,c){var a=c&&0<c.length,d=document.getElementById(b);d&&(d.innerHTML=a?c:"",d.style.display=a?"block":"none")};a.update=function(b){var h=document.getElementById("songTitle");h.innerHTML=0<b.title.length?b.title:"Untitled-Song";c("songArtist",b.artist);c("songAlbum",b.album);c("songSubtitle",b.st);h=document.getElementById("songMeta");if(!b.ugsMeta||1>b.ugsMeta.length)h.style.display="none";else{for(var a="",d=0;d<b.ugsMeta.length;d++)a+="<p>"+
b.ugsMeta[d]+"</p>";h.innerHTML=a;h.style.display="block"}};return a}();
ugsEditorPlus.styles=function(){var a={},c=null;a.Rules=null;a.getSheet=function(b){a:{for(var h=0;h<document.styleSheets.length;h++)if(document.styleSheets[h].title==b){c=document.styleSheets[h];break a}c=null}b=null==c?[]:c.cssRules?c.cssRules:c.rules;a.Rules=b;return this};a.Find=function(b){b=b.toLowerCase();for(var c=0;c<a.Rules.length;c++)if(a.Rules[c].selectorText&&a.Rules[c].selectorText.toLowerCase()==b)return a.Rules[c];return null};return a}();
ugsEditorPlus.themes=function(){var a={},c={normal:{name:"Normal (white paper)",selectText:"Normal colors (white paper)",description:"Simple, legible text on white paper",song:{fretLines:"#003366",dots:"#ff0000",dotText:"#ffffff",text:"#000000",fretText:"#4a4a4a"},tabs:{lines:"#999999",dots:"#eaeaea",text:"#000000"}},reversed:{name:"Reversed for projectors",selectText:"Reversed colors (for projectors)",description:"Light text on dark background",song:{fretLines:"#365F70",dots:"#FDD96F",dotText:"#000000",
text:"#FF6040",fretText:"#999999"},tabs:{lines:"#365F70",dots:"#FDD96F",text:"#000000"}},frosty:{name:"Frostcicle",selectText:"Frostcicle (cool blue)",description:"Brrrr... icy cool blues",song:{fretLines:"#66B4CC",dots:"#332335",dotText:"#9FE1F9",text:"#0896FE",fretText:"#E3D8BA"},tabs:{lines:"#6699FF",dots:"#EFFCF9",text:"#00558E"}},jellyBean:{name:"Jelly Beans",selectText:"Jelly Beans (vibrant)",description:"Sugary, vibrant bowl of jelly beans!",song:{fretLines:"#49BC45",dots:"#FF9417",dotText:"#FCF49F",
text:"#D20070",fretText:"#4a4a4a"},tabs:{lines:"#6699FF",dots:"#FFF9BA",text:"#75003E"}},justBlack:{name:"Just Black",selectText:"Black (for laser printers)",description:"No color, but black, best for B&W laser printers",song:{fretLines:"#cccccc",dots:"#000000",dotText:"#ffffff",text:"#000000",fretText:"#000000"},tabs:{lines:"#cccccc",dots:"#000000",text:"#ffffff"}},krampus:{name:"Gruss vom Krampus",selectText:"Krampus (Ye Olde Christmas)",description:"Seasons Greetin's, Happy Holidays, Merry Christmas, Krampus Nichte!",
song:{fretLines:"#929867",dots:"#A22C27",dotText:"#EBD592",text:"#4F2621",fretText:"#4a4a4a"},tabs:{lines:"#B69C01",dots:"#E1EEC8",text:"#75003E"}},western:{name:"Out West",selectText:"Out West (dust country)",description:"Dusty Honky Tonk/Country/Western look",song:{fretLines:"#B5A679",dots:"#CF8300",dotText:"#ffffff",text:"#386571",fretText:"#4a4a4a"},tabs:{lines:"#697665",dots:"#F1E3C5",text:"#632424"}},pumpkin:{name:"Pumpkin Pie",selectText:"Pumpkin Pie (fall colors)",description:"Fall 'n Halloween 'n Jack o'Lantern 'n Thanksgiving Fun",
song:{fretLines:"#8E9A6C",dots:"#DA6328",dotText:"#FFEE4A",text:"#68391D",fretText:"#B14623"},tabs:{lines:"#BED379",dots:"#FFF4D8",text:"#B14623"}},notebook:{name:"Rock Notebook",selectText:"Rock Notebook (marker)",description:"A strong, hand-scrawled, and edgily unreliable look",song:{fretLines:"#747CAD",dots:"#1C0866",dotText:"#ffffff",text:"#B22000",fretText:"#A4A0B2"},tabs:{lines:"#A4A0B2",dots:"#F1E3C5",text:"#2E2ECC"}},zombie:{name:"Zombies!!!",selectText:"Zombies!!!",description:"Blood 'n gore for Halloween",
song:{fretLines:"#9EB036",dots:"#E52501",dotText:"#FEDA79",text:"#798666",fretText:"#B14623"},tabs:{lines:"#602749",dots:"#F7F9EA",text:"#4F5F3E"}}};a.getDescription=function(b){return c[b].selectText};a.loadList=function(b){var a="",k;for(k in c)c.hasOwnProperty(k)&&(a+='<li class="'+("normal"==k?"checked":"")+'"><a href="#'+k+'" title="'+c[k].description+'">'+c[k].name+"</a></li>");$(b).html(a)};a.set=function(b){var a=$("body"),k;for(k in c)c.hasOwnProperty(k)&&a.removeClass("theme-"+k);a.addClass("theme-"+
b);b=c[b];ukeGeeks.settings.colors=b.song;ukeGeeks.settings.tabs.lineColor=b.tabs.lines;ukeGeeks.settings.tabs.dotColor=b.tabs.dots;ukeGeeks.settings.tabs.textColor=b.tabs.text};return a}();
ugsEditorPlus.optionsDlg=function(){var a={},c=null,b,h,k;a.init=function(a){c=a;b=document.getElementById("commonChordList");h=document.getElementById("chkIgnoreCommon");k=document.getElementById("chkEnclosures");b.value=ukeGeeks.settings.commonChords.join(", ");h.checked=ukeGeeks.settings.opts.ignoreCommonChords;k.checked=!ukeGeeks.settings.opts.retainBrackets;document.getElementById("updateBtn").onclick=function(){c("update",null);return!1};k.onclick=function(){c("showEnclosures",!this.checked)};
b.onchange=function(){c("setCommonChords",b.value)};h.onclick=function(){c("hideCommonChords",this.checked)};$(".checkboxBlock label, input[type=checkbox]").click(function(b){b.stopPropagation()});$(".overlay").draggable({handle:"hgroup"})};return a}();var ugsEditorPlus=window.ugsEditorPlus||{};
ugsEditorPlus.reformat=function(){var a={},c=!1,b=function(){this.source="";this.spaceCount=this.wordCount=0;this.words=[];this.lineType=this.chordCount=0},h=/\b(\S+)\b/gi,k=/(\s+)/g,d=/(^\s+)/,l=/\b[A-G][#b]?(m|m6|m7|m9|dim|dim7|maj7|sus2|sus4|aug|6|7|9|add9|7sus4)?\b/,n=/\b(\S+\s*)/g,p=/^\s*(\|{0,2}[A-Gb]?\|{0,2}[-x0-9|:]{4,})/;a.run=function(a){c=!1;var m=[];a=a.replace("\t","    ");a=a.split("\n");for(var f=0;f<a.length;f++){var g=a[f].match(h),e=new b;e.source=a[f];if(null!=g&&0<g.length){e.wordCount=
g.length;e.words=g;for(var r=e,s=0,t=0;t<g.length;t++)g[t].match(l)&&s++;r.chordCount=s}r=a[f].match(k);null!=r&&0<r.length&&(e.spaceCount=r.length);r=e;g=e;1>g.spaceCount+g.wordCount?g=0:null!=g.source.match(p)?g=3:(s=2,0<g.chordCount&&g.wordCount==g.chordCount&&(s=1,c=!0),g=s);r.lineType=g;m.push(e)}f="";for(a=0;a<m.length;)if(e=m[a],r=m[a+1],a++,r&&0!=e.lineType){if(g=3==e.lineType)a:if(a+3>=m.length)g=!1;else{for(g=a;g<a+3;g++)if(3!=m[g].lineType){g=!1;break a}g=!0}if(g)f+="{start_of_tab}\n"+
e.source.replace(d,"")+"\n"+r.source.replace(d,"")+"\n"+m[a+1].source.replace(d,"")+"\n"+m[a+2].source.replace(d,"")+"\n{end_of_tab}\n",a+=3;else if(1!=e.lineType||2!=r.lineType){if(1==e.lineType){e=e.source.replace(k," ").split(" ");r="";for(g=0;g<e.length;g++)0<e[g].length&&(r+="["+e[g]+"] ");e=r+"\n"}else e=e.source+"\n";f+=e}else{a++;s=e.source;for(e=r.source;e.length<s.length;)e+=" ";r="";g=s.match(n);t=s.match(d);s=0;t&&(r+=e.substr(s,t[0].length),s=t[0].length);for(t=0;t<g.length;t++)r+="["+
g[t].replace(k,"")+"]"+e.substr(s,g[t].length),s+=g[t].length;s<e.length&&(r+=e.substr(s,e.length));f+=r+"\n"}}else f+=e.source+"\n";return f};a.hasChords=function(){return c};return a}();
ugsEditorPlus.autoReformat=function(){var a={},c={},b,h=!1;a.run=function(a){h||(c=a,c.reformatTextBox=document.getElementById("reformatSource"),c.reformatDlg=document.getElementById("reformatDlg"),document.getElementById("reformatYesBtn").onclick=function(){c.cpmSource.value=b;k();ugsEditorPlus.actions.run(!0);return!1},document.getElementById("reformatNoBtn").onclick=function(){k();return!1},a=document.getElementById("reformatDisable"),a.checked=!1,a.onclick=function(){h=this.checked},b=ugsEditorPlus.reformat.run(c.cpmSource.value),
c.reformatTextBox.innerHTML=b,ugsEditorPlus.reformat.hasChords()&&ukeGeeks.toolsLite.removeClass(c.reformatDlg,"isHidden"))};var k=function(){ukeGeeks.toolsLite.addClass(c.reformatDlg,"isHidden")};return a}();
ugsEditorPlus.topMenus=function(){var a={init:function(){$("#ugsAppToolbar > ul li").not("[data-dialog]").children("a").click(c);$(".showOptionsBox a").click(l);$("#ugsAppToolbar > ul li[data-dialog]").click(h);$(".closeBtn").click(k);$(".resizeBtn").click(d)}},c=function(){var a=$(this).parent(),c=a.hasClass("active");b();c||a.addClass("active")},b=function(){$("#ugsAppToolbar > ul > li").removeClass("active")},h=function(a){a=$(this).data("dialog");$("#"+a).fadeIn();return!1},k=function(a){$(this).parents(".overlay").fadeOut();
return!1},d=function(a){a=$(this).parents(".overlay");ugsEditorPlus.resize.toggle(a);return!1},l=function(a){a=$(this).attr("href");$(".arrowBox").not(a).hide();a=$(a);a.find("dd").hide();a.fadeToggle();ugsEditorPlus.submenuUi.reset(a);return!1};a.makeAllInactive=b;return a}();
ugsEditorPlus.submenuUi=function(){var a={},c=null,b=null;a.init=function(a){b=a;ugsEditorPlus.themes.loadList("#colorPicker .pseudoSelect");$(".enablePseudoSelects label").click(k);$(".pseudoSelect li").click(h);$("body").bind("click",n);$(".arrowBox").click(l)};var h=function(a){a=$(this);var f;f=a.children().attr("href");f="#"==f[0]?f.substr(1):f;var g=a.parents("dd"),e=g.attr("id"),g=g.data("action");$("#"+e).hide().find("li").removeClass("checked");a.addClass("checked");d(this,!1);c=null;$("label[for="+
e+"] span").text(q(g,f,a));$("label[for="+e+"]").parents("dt").removeClass("active");b(g,f);return!1},k=function(a){a=$(this);var b=a.attr("for");a.closest("dl").children("dt").removeClass("active");a.closest("dt").addClass("active");$("#"+b).show();d(this,!0);null!=c&&$("#"+c.id).hide();c=null!=c&&c.id==b?null:{id:b};return!1};a.reset=function(a){a.find("dt").removeClass("active");a.find(".event-userSelecting").removeClass("event-userSelecting")};var d=function(a,b){$(a).parents(".enablePseudoSelects").toggleClass("event-userSelecting",
b)},l=function(a){if(!$(a.target).is("a"))return $(this).find("dd").hide(),c=null,!1},n=function(a){$(".arrowBox").fadeOut(270);ugsEditorPlus.topMenus.makeAllInactive()},p={zoomDiagrams:["Tiny","Small","Medium","Large","Stupid Large"],layout:["Reference diagrams on left","Reference diagrams at top","No reference diagrams"],placement:["Chord names inline with lyrics","Chord names above lyrics","Names & diagrams above lyrics"],tuning:["Soprano (GCEA) tuning","Baritone (DBEA) tuning"]},q=function(a,
b,c){var e=c.index();switch(a){case "paper":return"Width "+c.text();case "zoomFonts":return"Font size "+b+"pt";case "zoomDiagrams":return p.zoomDiagrams[e]+" diagrams";case "colors":return ugsEditorPlus.themes.getDescription(b);case "transpose":return"up_0"==b?"Original key":c.text().replace(" ",' steps - "')+'"';default:return p[a][e]}};a.resetTransposeLabel=function(){$("label[for=transposePicker] span").text("Original key")};return a}();
ugsEditorPlus.newSong=function(){var a={},c=!1,b="";a.init=function(a){b=a;$("#newSongBtn").click(function(a){a=$("#songTitle");var b=a.val().trim();a.val(b);a=2<b.length;k(!a,"Song's title is required<br/><em>(you may change it later, must be at least 2 characters)</em>");a&&h()});$("#openNewDlgBtn").click(function(a){$("#songTitle, #songArtist").val("");$("#newSongForm").fadeIn();$("#songTitle").focus()});$("#hideNewSongBtn").click(d);$("#newSongForm").bind("keydown",l);var p=$("#loadingSpinner");
p.hide();$(document).ajaxStart(function(){p.show();c=!0}).ajaxStop(function(){p.hide();c=!1})};var h=function(){if(!c){var a={handler:"ugs_new",songTitle:$("#songTitle").val(),songArtist:$("#songArtist").val()};$.ajax({url:b,type:"POST",dataType:"json",data:JSON.stringify(a),success:function(a){k(a.HasErrors,a.Message);a.HasErrors||(document.location.href=a.ContinueUri)}})}},k=function(a,b){var c=$("#newSongForm .errorMessage");a?(c.show().html(b),$("#songTitle").focus()):c.hide()},d=function(a){$("#newSongForm").fadeOut()},
l=function(a){27==a.which&&d()};return a}();
ugsEditorPlus.updateSong=function(){var a={},c="",b="",h=!1;a.init=function(a,l){c=a;b=l;$("#saveBtn").click(function(a){k();return!1});$("#messageBox").hide();$(document).ajaxStart(function(){$("#sourceFeedback").hide().html();$("#messageBox").slideDown("fast");$("#loadingSpinner").show();h=!0}).ajaxStop(function(){$("#messageBox").delay(3E3).fadeOut("slow");h=!1})};var k=function(){if(!h){$("#sourceFeedback").show();var a={handler:"ugs_update_81jr",filename:b,song:$("#chordProSource").val()};$.ajax({url:c,
type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(a),success:function(a){a=a.Message;$("#loadingSpinner").hide();$("#sourceFeedback").show().html(a)}})}};return a}();
ugsEditorPlus.typeahead=function(){var a={},c=[],b={},h="",k,d=[],l=/\s{2,}/g,n=/([^a-z0-9]+)/gi,p=/['`\u2019-]/g,q=function(){$("li").each(function(a){var e=$(this);a=m(e.text());var g=e.children("a").attr("href"),f=g.toLowerCase(),e=e.children("a").html(),e=e.replace('<strong class="','<span class="bigger ').replace("</strong>","</span>");b[f]={html:e,searchText:a,code:f,href:g};c.push(f)})},m=function(a){return a.toLowerCase().replace(p,"").replace(n," ").replace(l," ").trim()},f=function(a,b){h=
m(a);d=h.split(" ");for(var e="",f=0;f<d.length;f++)d[f]=d[f].trim(),0<d[f].length&&(e+=(0<e.length?"|":"")+d[f]);k=RegExp("("+e+")","gi");b(c)},g=function(a){window.location=b[a].href;return b[a].searchText},e=function(a){a=b[a];for(var e=0;e<d.length;e++)if(-1==a.searchText.indexOf(d[e]))return!1;return!0},r=function(a){return a.sort(function(a,e){return b[a].searchText>b[e].searchText})},s=function(a){a=$("<div/>").html(b[a].html);$("em, .bigger",a).each(function(a){a=$(this);var b=a.html();a.html(b.replace(k,
"<strong>$1</strong>"))});return a.html()};a.initialize=function(){q();$("#quickSearch").typeahead({source:f,updater:g,matcher:e,sorter:r,highlighter:s,minLength:2,items:50}).val("").focus()};return a};
ugsEditorPlus.resize=function(){var a={},c=null,b=null,h=null,k=null,d=!1,l=!1,n=function(a){c=$(a);$("body").append('<div id="aceHeader"><button class="aceSideBtn" title="Show options &amp; help"><span></span><span></span><span></span></button><strong>Edit Song</strong><a href="#exit-fullscreen">Exit fullscreen</a></div><div id="aceEditor"></div><div id="aceHelp"></div>');b=$("#aceEditor");b.fadeOut(1);h=$("#aceHelp");$("#aceHeader a").click(function(a){a.preventDefault();g()});$("#aceHeader button").click(p)},
p=function(a){a.preventDefault();q(!l)},q=function(a){(l=a)?(h.animate({left:0},400),b.animate({left:"350px"},400)):(h.animate({left:"-350px"},400),b.animate({left:0},400))},m=function(){d=!0;$("html").addClass("aceEditorActive");$(".overlay").fadeOut(300);null===k?LazyLoad.js("/js/ace/ace.js",function(){k=ace.edit("aceEditor");k.setTheme("ace/theme/idle_fingers");k.getSession().setMode("ace/mode/chordpro");k.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0});k.completers=[ugsAce.chordCompleter];
f();h.html(ugsAce.helpHtml)}):f()},f=function(){b.fadeIn(550);k.setValue($("#chordProSource").val());k.gotoLine(1);h.fadeIn(1)},g=function(){d=!1;c.show();b.fadeOut(550);h.fadeOut(550);null!==k&&$("#chordProSource").val(k.getValue());$("html").removeClass("aceEditorActive");q(!1)};a.toggle=function(a){null===c&&n(a);d?g():m();return!1};return a}();
ugsEditorPlus.chordBuilder=function(){var a={},c=null;a.init=function(){var a=$(".fingerToolImage").css("background-image");ugsChordBuilder.settings.cursor.imageUri=a.replace(/url\("(.*)hand.png"\)/i,"$1hand-cursor.png");c=new ugsChordBuilder.editorUi;c.init();$("#cdBldOpenBtn").click(b)};var b=function(a){a.preventDefault();c.reload();a=$(this).data("dialog");$("#"+a).fadeIn()};return a}();var ugsChordBuilder=window.ugsChordBuilder||{};
ugsChordBuilder.entities={BoundingBox:function(a,c){this.x=a?a.x:0;this.y=a?a.y:0;this.width=c?c.width:1;this.height=c?c.height:1},Dot:function(a,c,b){this.string=a;this.fret=c?c:0;this.finger=b?b:0},Position:function(a,c){this.x=a?a:0;this.y=c?c:0}};
ugsChordBuilder.settings=function(){var a=ugsChordBuilder.entities,c={x:75,y:75},b={numFrets:5,maxFret:16,stringNames:["G","C","E","A"],strokeWidth:4,strokeColor:"#8F8569",fretSpace:35,stringSpace:30},h=function(){return{height:b.fretSpace,width:b.stringSpace}};return{anchorPos:c,cursor:{fillColor:"rgba(220, 216, 73, 0.35)",strokeWidth:1,strokeColor:"#AAB444",radius:9,imageUri:"/img/editor/hand-cursor.png"},fretBoard:b,dot:{fillColor:"#F68014",radius:11,strokeWidth:2,strokeColor:"#D56333",fontWeight:"bold",
fontFamily:'Arial, "Helvetica Neue", Helvetica, Verdana, sans-serif',fontSize:16,fontColor:"#ffffff"},fretLabel:{fontFamily:'Arial, "Helvetica Neue", Helvetica, Verdana, sans-serif',fontSize:28,color:"#6A6A63",lightColor:"#EAEAE8"},stringLabel:{fontFamily:'Arial, "Helvetica Neue", Helvetica, Verdana, sans-serif',fontSize:34,color:"#DCD849"},chord:{nameMaxLength:20},targetDimensions:h,targetAnchorPos:function(){var k=h();return new a.Position(c.x-0.5*k.width,c.y-k.height-0.2*b.strokeWidth)},centerAnchor:function(a){c.x=
0.5*a.width-0.5*(b.stringNames.length-1)*b.stringSpace-b.strokeWidth;c.y=0.5*a.height-0.5*b.numFrets*b.stringSpace}}}();
ugsChordBuilder.tracking=function(){var a=ugsChordBuilder.entities,c=ugsChordBuilder.settings,b={},h=null;b.toDot=function(b){var d=new a.BoundingBox(b),l;h||(l=c.targetDimensions(),l.width*=c.fretBoard.stringNames.length,l.height*=c.fretBoard.numFrets+1,h=new a.BoundingBox(c.targetAnchorPos(),l));l=h;if(!(d.x<l.x+l.width&&d.x+d.width>l.x&&d.y<l.y+l.height&&d.y+d.height>l.y))return null;d=c.targetDimensions();return new a.Dot(Math.floor((b.x-l.x)/d.width),Math.floor((b.y-l.y)/d.height))};return b}();
ugsChordBuilder.fretDots=function(){var a=ugsChordBuilder.entities,c=ugsChordBuilder.settings.anchorPos,b=ugsChordBuilder.settings.fretBoard,h=ugsChordBuilder.settings.dot,k={},d=[];k.getDots=function(){return d.slice()};k.slide=function(a){var c;a:{for(c=0;c<d.length;c++)if(1>d[c].fret+a||d[c].fret+a>b.numFrets){c=!1;break a}c=!0}if(!c)return!1;for(c=0;c<d.length;c++)d[c].fret+=a;return!0};k.toggleDot=function(a){if(0==a.fret)n(a.string);else{var b=l(a);0>b?d.push(a):d.splice(b,1)}};k.toggleFinger=
function(a,b){var c=l(a);if(0>c)return!1;d[c].finger=d[c].finger==b?0:b;return!0};k.reset=function(){for(var a=0;a<b.stringNames.length;a++)n(a)};var l=function(a){for(var b=d.length-1;0<=b;b--)if(d[b].string==a.string&&d[b].fret==a.fret)return b;return-1},n=function(a){for(var b=d.length-1;0<=b;b--)d[b].string==a&&d.splice(b,1)};k.draw=function(k){for(var l=d.length-1;0<=l;l--){var m;m=d[l];m=new a.Position(c.x+0.47*b.strokeWidth+m.string*b.stringSpace,c.y+0.47*b.strokeWidth+(m.fret-0.5)*b.fretSpace);
var f=k,g=m;f.beginPath();f.arc(g.x,g.y,h.radius,0,2*Math.PI,!1);f.fillStyle=h.fillColor;f.fill();f.lineWidth=h.strokeWidth;f.strokeStyle=h.strokeColor;f.stroke();0<d[l].finger&&(f=k,g=d[l].finger,f.font=h.fontWeight+" "+h.fontSize+"px "+h.fontFamily,f.textAlign="center",f.fillStyle=h.fontColor,f.fillText(g,m.x,m.y+0.3*h.fontSize))}};return k}();
ugsChordBuilder.cursorCanvas=function(){var a=ugsChordBuilder.settings.cursor,c=ugsChordBuilder.settings.dot,b={},h=null,k=null,d=!1,l=!0,n=1,p={x:0,y:0};b.init=function(a){h=a;q()};var q=function(){k=new Image;k.onload=function(){d=!0};k.src=a.imageUri};b.setCursor=function(a,b){l=a;n=b};b.draw=function(b){var f=a.radius+a.strokeWidth;h.clearRect(p.x-f,p.y-f,f+50,f+60);!d||l?(h.beginPath(),h.arc(b.x,b.y,a.radius,0,2*Math.PI,!1),h.fillStyle=a.fillColor,h.fill(),h.lineWidth=a.strokeWidth,h.strokeStyle=
a.strokeColor,h.stroke()):(h.drawImage(k,b.x,b.y),h.font=c.fontWeight+" "+c.fontSize+"px "+c.fontFamily,h.textAlign="left",h.fillStyle="black",h.fillText(n,b.x+0.8*k.width,b.y+k.height));p=b};return b}();
ugsChordBuilder.chordCanvas=function(){var a=ugsChordBuilder.entities,c=ugsChordBuilder.settings.centerAnchor,b=ugsChordBuilder.settings.anchorPos,h=ugsChordBuilder.settings.fretLabel,k=ugsChordBuilder.settings.stringLabel,d=ugsChordBuilder.settings.fretBoard,l={},n=null,p=null;l.init=function(a,b){n=a;p=b;c(p)};l.draw=function(c,m){n.clearRect(0,0,p.width,p.height);for(var f=new a.Position(b.x-0.3*h.fontSize,b.y+h.fontSize),g=1<m?h.color:h.lightColor,e=0;e<d.numFrets;e++){var r=m+e,l=f;n.font=h.fontSize+
"px "+h.fontFamily;n.textAlign="right";n.fillStyle=g;n.fillText(r,l.x,l.y);f.y+=d.fretSpace;g=h.lightColor}f=new a.Position(b.x+0.5*d.strokeWidth,b.y-0.25*h.fontSize);for(e=0;e<d.stringNames.length;e++)r=d.stringNames[e],g=f,n.font=k.fontSize+"px "+k.fontFamily,n.textAlign="center",n.fillStyle=k.color,n.fillText(r,g.x,g.y),f.x+=d.stringSpace;e=d.strokeWidth/2;r=d.numFrets*d.fretSpace;g=(d.stringNames.length-1)*d.stringSpace;n.beginPath();for(f=1;f<d.stringNames.length-1;f++)l=b.x+f*d.stringSpace+
e,n.moveTo(l,b.y+e),n.lineTo(l,b.y+r+e);for(f=1;f<d.numFrets;f++)l=b.y+f*d.fretSpace+e,n.moveTo(b.x+e,l),n.lineTo(b.x+g+e,l);n.rect(b.x+e,b.y+e,g,r);n.strokeStyle=d.strokeColor;n.lineWidth=d.strokeWidth;n.stroke();n.closePath();ugsChordBuilder.fretDots.draw(n)};return l}();
ugsChordBuilder["export"]=function(){var a=ugsChordBuilder.settings.fretBoard,c=ugsChordBuilder.settings.chord,b={},h=null,k=function(a,b){this.string=a;this.dots=b?b:[]},d=function(){var b,c=[];for(b=1;b<=a.stringNames.length;b++)c.push(new k(b));var g=ugsChordBuilder.fretDots.getDots();for(b=c.length-1;0<=b;b--)for(var e=g.length-1;0<=e;e--)c[b].string==g[e].string+1&&c[b].dots.push(g[e]);return c},l=function(a){for(var b=0,c=900,e=a.length-1;0<=e;e--)a[e].fret>b&&(b=a[e].fret),a[e].fret<c&&(c=
a[e].fret);return{max:b,min:900>c?c:b}},n=function(a){return 0<a?h+a:0},p=function(a,b){for(var c=0;c<a.length;c++)if(a[c].fret==b)return a[c].finger;return 0};b.getPrimaryFrets=function(a){h=a-1;a=d();for(var b=[],c=0;c<a.length;c++){var e=l(a[c].dots);b.push(n(e.max))}return b};b.getDefinition=function(a,b){var c=(a=q(a))&&0<a.length?a:"CHORDNAME",e="",k="",s="";h=b-1;for(var t=d(),x=0;x<t.length;x++){var w=l(t[x].dots),e=e+(n(w.max)+" "),k=k+(p(t[x].dots,w.max)+" ");w.max!=w.min&&(s+=" add: string "+
t[x].string+" fret "+n(w.min)+" finger "+p(t[x].dots,w.min))}return("{define: "+c+" frets "+e+" fingers "+k+s+"}").replace(/\s+/g," ").replace(" }","}")};b.getDefinitionHtml=function(a,c){a=q(a);var d=b.getDefinition(a,c),d=d.replace(" "+a," X07Myq791wso01"),d=d.replace(/\b(\d+)\b/g,'<span class="chordPro-X07MX001number">$1</span>'),d=d.replace(/\b(frets?|fingers?|string)\b/g,'<span class="chordPro-X07MX001attribute">$1</span>'),d=d.replace(/\b(define|add)\b/g,'<span class="chordPro-X07MX001keyword">$1</span>');
return d.replace("X07Myq791wso01",'<span class="chordPro-string">'+a+"</span>").replace(/X07MX001/g,"").replace(/ +/g," ")};var q=function(a){a=a.replace(/^\s*(.*?)\s*$/,"$1").replace(/\s+/g,"-");/^(frets|fingers|add:)$/i.test(a)&&(a="");return a.substring(0,c.nameMaxLength)};return b}();
ugsChordBuilder.chooserList=function(){var a={},c=[],b=null,h=0,k=null,d=function(){},l=null,n={showText:!1,height:50,width:40,fretSpace:9,stringSpace:7,dotRadius:3,lineWidth:1,topLeftPos:{x:10,y:2},xWidth:0.7*7,xStroke:1.4},p={dot:"8pt Arial",text:"8pt Arial",fret:"8pt Arial"},q={fretLines:"#EED18E",dots:"#551D00",dotText:"#ffffff",text:"#000000",fretText:"#EED18E",xStroke:"#551D00"},m=function(a,b){this.id=h++;this.name=a;this.definition=b};a.init=function(a){d=a;b=document.getElementById("cdBldPick");
b.addEventListener("click",g,!1);f()};var f=function(){for(var a=/\{define:\s*([^}]+?)\s+frets[^}]+?\}/im,e=document.getElementById("chordProSource").value.split("\n"),d=e.length-1;0<=d;d--)a.test(e[d])&&A(e[d].replace(a,"$1"),e[d]);for(var e=b,d=c,f="",a=0;a<d.length;a++)f+=r(d[a].id,d[a].name);e.innerHTML='<li data-id="-1" class="newChord">+ Add New Chord</li>'+f;e=e.getElementsByTagName("li");for(a=e.length-1;0<=a;a--)1>a||s(e[a].getAttribute("data-id"))};a.reset=function(){c=[];document.getElementById("cdBldPick").innerHTML=
"";h=0;k=null;f()};a.show=function(a){document.getElementById("cdBldChooserPanel").style.display=a?"block":"none";document.getElementById("cdBldBuilderPanel").style.display=a?"none":"block";$("#cdBldChooserPanel").closest(".overlay").toggleClass("chordBuilderNarrow",a)};a.save=function(d){var f;a:{f=null==k?-1:k.id;for(var h=d.name.toLowerCase(),g=c.length-1;0<=g;g--)if(""+c[g].id!=""+f&&c[g].name.toLowerCase()==h){f=g;break a}f=-1}if(0<=f)return alert("Hey, this chord name is already being used."),
!1;f=-1;if(null==k){f=A(d.name,d.definition);k=z(f);d=d.definition;for(var h=document.getElementById("chordProSource"),g=/\s*\{\s*(title|t|artist|subtitle|st|album|define):.*?\}/im,l=h.value.split("\n"),m="",n=!1,p=l.length-1;0<=p;p--)!n&&g.test(l[p])&&(m=d+"\n"+m,n=!0),m=l[p]+"\n"+m;n||(m=d+"\n"+h.value);h.value=m;ugsEditorPlus.actions.run()}else{h=w(k.id);if(0>h)return!1;g=c[h].definition;c[h].name=d.name;c[h].definition=d.definition;f=c[h].id;x(g,c[h].definition)}d=z(f);(h=e(f))?h.innerHTML=r(f,
d.name,!0):(d=d.name,h=document.createElement("ul"),h.innerHTML=r(f,d),b.appendChild(h.childNodes[0]));s(f);a.show(!0);return!0};var g=function(c){c.preventDefault();k=z(c.target.getAttribute("data-id"));if("delete"==c.target.getAttribute("data-action")){if(c=k,confirm('Delete definition for "'+c.name+'"?')){var f=e(c.id);f&&(b.removeChild(f),x(c.definition,""))}}else{c=null;if(null!=k){c=ukeGeeks.chordImport.runLine(k.definition);a:{if(c.muted)for(f=0;f<c.muted.length;f++)if(c.muted[f]){f=!0;break a}f=
!1}f&&alert("Uh-oh! This chord uses muted strings!\nCurrently the Chord Builder does not support muted strings -- \nsaving edits will result in mutes being lost.")}d(c);a.show(!1)}},e=function(a){for(var c=b.getElementsByTagName("li"),e=0;e<c.length;e++)if(c[e].getAttribute("data-id")==""+a)return c[e];return null},r=function(a,b,c){c=2<arguments.length?c:!1;var e='<span class="deleteChord" data-id="'+a+'" data-action="delete" title="Remove this definition"></span>'+b;return c?e:'<li data-id="'+a+
'" title="Edit this definition" class="ugs-grouped">'+e+"</li>"},s=function(a){var b=e(a);a=z(a);a=ukeGeeks.chordImport.runLine(a.definition);null==l&&(l=new ukeGeeks.chordBrush);l.plot(b,a,n,p,q)},t=function(a,b,c){var e=a.replace(b,c);return e==a?a:t(e,b,c)},x=function(a,b){var c=document.getElementById("chordProSource");c.value=t(c.value,a,b);ugsEditorPlus.actions.run()},w=function(a){for(var b=0;b<c.length;b++)if(""+c[b].id==a)return b;return-1},z=function(a){a=w(a);return 0<=a?c[a]:null},A=function(a,
b){var e=new m(a,b);c.push(e);return e.id};return a}();
ugsChordBuilder.editorUi=function(){var a=null,c=null,b=null,h=1,k="",d=!0,l=0,n={0:"None",1:"Index finger",2:"Middle finger",3:"Ring finger",4:"Pinkie"};this.init=function(){a=document.getElementById("cdBldCursorCanvas");if(!a.getContext)return!1;for(var e=a.getContext("2d"),d=document.getElementById("cdBldDiagramCanvas").getContext("2d"),h=document.getElementById("cdBldStartingFret"),k="",l=ugsChordBuilder.settings.fretBoard.maxFret-ugsChordBuilder.settings.fretBoard.numFrets+1,n=1;n<=l;n++)k+=
'<option value="'+n+'">'+n+"</option>";h.innerHTML=k;h.addEventListener("change",x,!1);document.getElementById("cdBldChordName").addEventListener("keyup",t,!1);c=document.getElementById("cdBldDotsBtn");b=document.getElementById("cdBldFingersBtn");c.addEventListener("click",r,!1);b.addEventListener("click",r,!1);document.getElementById("cdBldShowOutputBtn").addEventListener("click",q,!1);document.getElementById("cdBldCancelBtn").addEventListener("click",m,!1);document.getElementById("cdBldSaveBtn").addEventListener("click",
f,!1);document.getElementById("toolboxSlideUpBtn").addEventListener("click",w,!1);document.getElementById("toolboxSlideDownBtn").addEventListener("click",w,!1);p();document.getElementById("cdBldEditorSurface").addEventListener("mousemove",z,!1);a.addEventListener("click",A,!1);ugsChordBuilder.chordCanvas.init(d,a);ugsChordBuilder.cursorCanvas.init(e);y();u();ugsChordBuilder.chooserList.init(g);return!0};var p=function(){l++;4<l&&(l=0);document.getElementById("cdBldBtnFingerName").innerHTML=n[l]+" ("+
l+")";document.getElementById("cdBldBtnDiagram").className="fingerToolImage finger"+l},q=function(a){s(document.getElementById("cdBldOutputBox"),"collapseOutput",!a.target.checked)},m=function(a){a.preventDefault();e();ugsChordBuilder.chooserList.show(!0)},f=function(a){a.preventDefault();a={name:k,startingFret:h,dots:ugsChordBuilder.fretDots.getDots(),definition:ugsChordBuilder["export"].getDefinition(k,h)};ugsChordBuilder.chooserList.save(a)||(a=document.getElementById("cdBldChordName"),a.focus(),
a.select())},g=function(a){if(null==a)e();else{var b;b=a.dots;for(var c=0,d=0;d<b.length;d++)b[d].fret>c&&(c=b[d].fret);b=c;b=b>ugsChordBuilder.settings.fretBoard.numFrets?b-ugsChordBuilder.settings.fretBoard.numFrets+1:1;c=e;d=a.name;a=a.dots;for(var f=b-1,h=[],g=0;g<a.length;g++){var k=a[g].fret-f;h.push(new ugsChordBuilder.entities.Dot(a[g].string,0>k?0:k,a[g].finger))}c(d,b,h,!1)}},e=function(a,e,f,g){g=3<arguments.length?g:!0;ugsChordBuilder.fretDots.reset();var r=g;k=a&&0<a.length?a:"CHORDNAME";
document.getElementById("cdBldChordName").value=k;h=e?e:1;document.getElementById("cdBldStartingFret").value=h;document.getElementById("cdBldShowOutputBtn").checked=!1;s(document.getElementById("cdBldOutputBox"),"collapseOutput",!0);document.getElementById("cdBldSaveBtn").value=r?"Add":"Update";d=!0;l=0;p();s(c,"selected",d);s(b,"selected",!d);s(document.getElementById("cdBldToolbox"),"open",!d);ugsChordBuilder.cursorCanvas.setCursor(d,l);if(f&&0<f.length)for(r=0;r<f.length;r++)ugsChordBuilder.fretDots.toggleDot(f[r]);
y();u()},r=function(a){a.preventDefault();a=0<=a.currentTarget.href.indexOf("#dots");a==d?a||(p(),ugsChordBuilder.cursorCanvas.setCursor(d,l)):(s(c,"selected",a),s(b,"selected",!a),s(document.getElementById("cdBldToolbox"),"open",!a),d=a,ugsChordBuilder.cursorCanvas.setCursor(d,l))},s=function(a,b,c){var e=0<=a.className.indexOf(b);c&&!e?a.className+=" "+b:!c&&e&&(a.className=a.className.replace(b,"").replace(/\s+/g," "))},t=function(a){k=this.value;u()},x=function(a){h=parseInt(this.value,10);u();
y()},w=function(a){a.preventDefault();var b=!1;a="up"==a.target.getAttribute("data-direction")?-1:1;if(ugsChordBuilder.fretDots.slide(a))b=!0;else{a=h+a;var c=ugsChordBuilder.settings.fretBoard.maxFret-ugsChordBuilder.settings.fretBoard.numFrets+1;1<=a&&a<=c&&(h=a,document.getElementById("cdBldStartingFret").value=a,b=!0)}b&&(y(),u())},z=function(a){ugsChordBuilder.cursorCanvas.draw(v(this,a))},A=function(b){b=v(a,b);var c=ugsChordBuilder.tracking.toDot(b);c&&(d?(ugsChordBuilder.fretDots.toggleDot(c),
y(b),u()):ugsChordBuilder.fretDots.toggleFinger(c,l)&&(y(b),u()))},v=function(a,b){var c=a.getBoundingClientRect();return new ugsChordBuilder.entities.Position(b.clientX-c.left,b.clientY-c.top)},y=function(a){a=a||new ugsChordBuilder.entities.Position(0,0);ugsChordBuilder.chordCanvas.draw(a,h)},u=function(){document.getElementById("cdBldOutput").innerHTML=ugsChordBuilder["export"].getDefinitionHtml(k,h)};this.reload=function(){e();ugsChordBuilder.chooserList.reset();ugsChordBuilder.chooserList.show(!0)}};
LazyLoad=function(a){function c(b,c){var d=a.createElement(b),f;for(f in c)c.hasOwnProperty(f)&&d.setAttribute(f,c[f]);return d}function b(a){var b=q[a],c,d;b&&(c=b.callback,d=b.urls,d.shift(),m=0,d.length||(c&&c.call(b.context,b.obj),q[a]=null,f[a].length&&k(a)))}function h(){var b=navigator.userAgent;n={async:!0===a.createElement("script").async};(n.webkit=/AppleWebKit\//.test(b))||(n.ie=/MSIE|Trident/.test(b))||(n.opera=/Opera/.test(b))||(n.gecko=/Gecko\//.test(b))||(n.unknown=!0)}function k(e,
g,k,m,x){var w=function(){b(e)},z="css"===e,A=[],v,y,u,B;n||h();if(g)if(g="string"===typeof g?[g]:g.concat(),z||n.async||n.gecko||n.opera)f[e].push({urls:g,callback:k,obj:m,context:x});else for(v=0,y=g.length;v<y;++v)f[e].push({urls:[g[v]],callback:v===y-1?k:null,obj:m,context:x});if(!q[e]&&(B=q[e]=f[e].shift())){p||(p=a.head||a.getElementsByTagName("head")[0]);g=B.urls.concat();v=0;for(y=g.length;v<y;++v)k=g[v],z?u=n.gecko?c("style"):c("link",{href:k,rel:"stylesheet"}):(u=c("script",{src:k}),u.async=
!1),u.className="lazyload",u.setAttribute("charset","utf-8"),n.ie&&!z&&"onreadystatechange"in u&&!("draggable"in u)?u.onreadystatechange=function(){/loaded|complete/.test(u.readyState)&&(u.onreadystatechange=null,w())}:z&&(n.gecko||n.webkit)?n.webkit?(B.urls[v]=u.href,l()):(u.innerHTML='@import "'+k+'";',d(u)):u.onload=u.onerror=w,A.push(u);v=0;for(y=A.length;v<y;++v)p.appendChild(A[v])}}function d(a){var c;try{c=!!a.sheet.cssRules}catch(f){m+=1;200>m?setTimeout(function(){d(a)},50):c&&b("css");return}b("css")}
function l(){var a=q.css,c;if(a){for(c=g.length;0<=--c;)if(g[c].href===a.urls[0]){b("css");break}m+=1;a&&(200>m?setTimeout(l,50):b("css"))}}var n,p,q={},m=0,f={css:[],js:[]},g=a.styleSheets;return{css:function(a,b,c,d){k("css",a,b,c,d)},js:function(a,b,c,d){k("js",a,b,c,d)}}}(this.document);