/**
  * <ul>
  * <li>Project: UkeGeeks' Scriptasaurus</li>
  * <li>Version: 1.4.3</li>
  * <li>Homepage: http://ukegeeks.com</li>
  * <li>Project Repository: https://github.com/buzcarter/UkeGeeks</li>
  * <li>Author: Buz Carter</li>
  * <li>Contact: buz@ukegeeks.com</li>
  * <li>Copyright: Copyright 2010-2014 Buz Carter.</li>
  * <li>License GNU General Public License (http://www.gnu.org/licenses/gpl.html)</li>
  * <ul>
  *
  * <p>== Overview
  * <p>Reads marked-up music (lyrics + chords) extracting all of the chords used;
  * Generates a chord diagrams using HTML5 &lt;canvas&gt; and rewrites the music with
  * standard HTML wrapping the chords.
  *
  * @module  scriptasaurus
  * @namespace  ukeGeeks
  */
var ukeGeeks = window.ukeGeeks || {};

;ukeGeeks.definitions=function(){var a={},c=[],b=[],d=[],e=0,f=[];a.instrument={sopranoUke:0,baritoneUke:5};a.addInstrument=function(a){d.push(a)};a.useInstrument=function(b){b=0<arguments.length?b:a.instrument.sopranoUke;e=parseInt(b,10);0<e&&(f=ukeGeeks.transpose.retune(e));a.setChords(ukeGeeks.chordImport.runBlock(d[0]).chords)};a.get=function(a){var b,d,g;for(b=0;b<c.length;b++)if(a==c[b].name)return c[b];if(1>e)return k(a);g=h(a);for(b in f)if(g==f[b].original&&(d=k(f[b].transposed)))return a=
new ukeGeeks.data.expandedChord(a),a.dots=d.dots,a.muted=d.muted,a;return null};var g={"A#":"Bb",Db:"C#","D#":"Eb",Gb:"F#",Ab:"G#"},h=function(a){var b=a.substr(0,2);return g[b]?g[b]+a.substr(2):a},k=function(a){var d,c=h(a);for(d=0;d<b.length;d++)if(c==b[d].name)return a=new ukeGeeks.data.expandedChord(a),a.dots=b[d].dots,a.muted=b[d].muted,a;return null};a.add=function(a){if(a.length)for(var b=0;b<a.length;b++)c.push(a[b]);return c.length};a.replace=function(b){c=[];return a.add(b)};a.getChords=
function(){return b};a.setChords=function(a){b=a};return a}();
ukeGeeks.settings=function(){var a={fonts:{dot:"9pt Arial Black,Arial",text:"bold 14pt Arial",fret:"bold 13pt Arial"},colors:{fretLines:"#003366",dots:"#ff0000",dotText:"#ffffff",text:"#000000",fretText:"#4a4a4a",xStroke:"#444444"},fretBox:{showText:!0,height:150,width:100,fretSpace:20,stringSpace:20,dotRadius:8,lineWidth:1.6,topLeftPos:{x:22,y:25},xWidth:9,xStroke:1.6*1.6},inlineFretBox:{showText:!1,height:50,width:40,fretSpace:9,stringSpace:7,dotRadius:3,lineWidth:1,topLeftPos:{x:10,y:2},xWidth:0.7*
7,xStroke:1.4,fonts:{dot:"8pt Arial",text:"8pt Arial",fret:"8pt Arial"}},ids:{songText:"ukeSongText",canvas:"ukeChordsCanvas",container:"ukeSongContainer"},wrapClasses:{wrap:"ugs-song-wrap",diagrams:"ugs-diagrams-wrap",text:"ugs-source-wrap"},opts:{columnsEnabled:!0,retainBrackets:!0,ignoreCommonChords:!1,autoFixOverlaps:!0},inlineDiagrams:!1,numFrets:5,tuning:["G","C","E","A"]};a.defaultInstrument=ukeGeeks.definitions.instrument.sopranoUke;a.tabs={lineSpacing:16,noteSpacing:14,lineWidth:1,lineColor:"#999999",
labelWidth:12,labelFont:"10pt Arial, Helvetica, Verdana, Geneva, sans-serif",dotColor:"#eaeaea",dotRadius:10,textFont:"bold 12pt Arial, Helvetica, Verdana, Geneva, sans-serif",textColor:"#000000",bottomPadding:10};a.environment={isIe:!1};a.commonChords="A B C D E F G Am".split(" ");var c=function(a,b){if("number"==typeof a)return a*b;if("object"==typeof a)for(var f in a)a[f]=c(a[f],b);return a},b=/\b(\d+)(pt|px)\b/;a.scale=function(a){if(1!=a){for(var e in this.fonts){var f=this.fonts,g=e,h;h=this.fonts[e];
var k=a,l=h.match(b);2>l.length||(k*=parseInt(l[1],10),h=h.replace(b,k+l[2]));f[g]=h}this.fretBox=c(this.fretBox,a)}};return a}();
ukeGeeks.data=function(){return{expandedChord:function(a){this.name=a;this.dots=[];this.muted=[]},song:function(){this.body=this.st2=this.st=this.artist=this.album=this.title="";this.hasChords=!1;this.ugsMeta=[];this.defs=[];this.chords=[]},dot:function(a,c,b){this.string=a;this.fret=c;this.finger=b},instrument:function(a,c,b,d){this.key=a;this.name=c;this.tuning=b;this.chords=d},htmlHandles:function(a,c,b){this.wrap=a;this.diagrams=c;this.text=b}}}();
ukeGeeks.toolsLite=function(){var a={},c=/\s{2,}/g,b=/^\s+|\s+$/g;a.addClass=function(b,c){a.hasClass(b,c)||(b.className+=" "+c)};a.hasClass=function(a,b){return a.className.match(RegExp("(\\s|^)"+b+"(\\s|$)"))};a.removeClass=function(b,c){a.hasClass(b,c)&&(b.className=b.className.replace(RegExp("(\\s|^)"+c+"(\\s|$)")," "))};a.setClass=function(b,c,f){f?a.addClass(b,c):a.removeClass(b,c)};a.trim=function(a){return a.replace(b,"")};a.pack=function(a){return a.replace(c," ").replace(b,"")};a.getElementsByClass=
function(a,b,c){var g;b||(b=document);if(b.getElementsByClassName)return b.getElementsByClassName(a);var h=[];c||(c="*");b=b.getElementsByTagName(c);c=b.length;var k=RegExp("(^|\\s)"+a+"(\\s|$)");for(g=a=0;a<c;a++)k.test(b[a].className)&&(h[g]=b[a],g++);return h};return a}();
ukeGeeks.chordImport=function(){var a={},c=function(a,b){this.define=a;this.adds=b},b=/\s*{?define\s*:(.*?)(}|add:)/i,d=/(add:.*?)(}|add:)/i,e=/(\S+)\s+/,f=/\s+frets\s+([\dx]{4}|(([\dx]{1,2}\s){3})[\dx]{1,2})/i,g=/\s+fingers\s+((\d\s+){3}\d|\d{4})/i,h=/add:\s*string\s*(\S+)\s+fret\s+(\d+)\sfinger\s(\d)/i,k=/{\s*instrument\s*:\s*(.*?)\s*}/i,l=/{\s*tuning\s*:\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S+)\s*}/i,n=/(\d{1,2}|x)/gi,p=/(.)/g,m=function(a){var e=ukeGeeks.toolsLite.pack(a);if(1<e.length&&"#"!=e[0]&&(a=
e.match(b))&&1<a.length){a=a[1];for(var f=[],g=e.match(d);g&&1<g.length;)f.push(g[1]),e=e.replace(g[1],""),g=e.match(d);return new c(a,f)}return null},q=function(a,b){var c=[],d=[];var k=a.match(f);if(k)for(var k=4==k[1].length?k[1].match(p):k[1].match(n),l=0;l<k.length;l++){var m="x"==k[l]||"X"==k[l];c[l]=m?0:parseInt(k[l],10);d[l]=m}k=(k=a.match(e))?k[1]:null;(l=a.match(g))?(l=l[1],4==l.length&&(l=l.replace(p,"$1 ")),l=l.split(" ")):l=[];if(null===k||"frets"==k)return s.push('bad "define" instruction: chord name not found: '+
a),null;if(null===c)return s.push('bad "define" instruction: frets not found: '+a),null;for(var k=new ukeGeeks.data.expandedChord(k),m=l,l=[],q=ukeGeeks.settings.tuning,r=0;r<q.length;r++){var t=parseInt(c[r],10);0<t&&l.push(new ukeGeeks.data.dot(r,t,m.length-1>=r?parseInt(m[r],10):0))}if(b&&!(1>b.length))for(var u in b)(c=b[u].match(h))&&2<c.length&&l.push(new ukeGeeks.data.dot(parseInt(c[1],10)-1,parseInt(c[2],10),parseInt(c[3],10)));k.dots=l;k.muted=d;return k},s=[];a.runLine=function(a){return(a=
m(a))?q(a.define,a.adds):null};a.runBlock=function(a){var b=a.split("\n");2>b.length&&(b=a.split("{"));var c=b,b=[],d;for(d in c){var e=m(c[d]);e&&b.push(e)}d=(d=a.match(k))?ukeGeeks.toolsLite.pack(d[1]):null;a=(a=a.match(l))?[a[1],a[2],a[3],a[4]]:null;var c=ukeGeeks.data.instrument,e=d.replace(" ","-"),f;for(f in a)e+="-"+a[f];f=e.toLowerCase();var e=[],g=null,h;for(h in b)(g=q(b[h].define,b[h].adds))&&e.push(g);return new c(f,d,a,e)};return a}();
ukeGeeks.transpose=function(){var a={},c=/^([A-G][#b]?)(.*)/,b={A:0,"A#":1,Bb:1,B:2,C:3,"C#":4,Db:4,D:5,"D#":6,Eb:6,E:7,F:8,"F#":9,Gb:9,G:10,"G#":11,Ab:11};a.shift=function(a,e){var f;f=a.match(c);f=!f||1>f.length?null:{tone:parseInt(b[f[1]],10),prefix:f[1],suffix:f[2]};if(null===f)return null;var g=(f.tone+e)%12;0>g&&(g+=12);for(var h in b)if(g==b[h])return h+f.suffix;return null};a.retune=function(){var b=0<arguments.length?arguments[0]:0,c=ukeGeeks.definitions.getChords(),f=[];if(0===b)for(var g in c)f.push({original:c[g].name,
transposed:c[g].name});else for(var h in c)f.push({original:c[h].name,transposed:a.shift(c[h].name,b)});return f};a.shiftChords=function(b,c){for(var f=[],g=0;g<b.length;g++)f.push(a.shift(b[g],c));return f};return a}();ukeGeeks.definitions.sopranoUkuleleGcea="{instrument: Soprano Ukulele}\n{tuning: G C E A}\n{define: A frets 2 1 0 0 fingers 1 2 0 0}\n{define: Am frets 2 0 0 0 fingers 1 0 0 0}\n{define: A7 frets 0 1 0 0 fingers 0 1 0 0}\n{define: A7sus4 frets 0 2 0 0 fingers 0 2 0 0}\n{define: Am7 frets 0 0 0 0}\n{define: Adim frets 2 3 2 3 fingers 1 3 2 4}\n{define: Amaj7 frets 1 1 0 0 fingers 1 2 0 0}\n{define: A6 frets 2 4 2 4 fingers 1 3 2 4}\n{define: Asus2 frets 2 4 5 2 fingers 2 3 4 1}\n{define: Asus4 frets 2 2 0 0 fingers 1 2 0 0}\n{define: Aaug frets 2 1 1 4 fingers 2 1 1 4 add: string 1 fret 1 finger 1 add: string 4 fret 1 finger 1}\n{define: Am6 frets 2 4 2 3 fingers 1 3 1 2 add: string 2 fret 2 finger 1}\n{define: A9 frets 0 1 0 2 fingers 0 1 0 2}\n{define: Bb frets 3 2 1 1 fingers 3 2 1 1}\n{define: Bbm frets 3 1 1 1 fingers 3 1 1 1 add: string 1 fret 1 finger 1}\n{define: Bb7 frets 1 2 1 1 fingers 1 2 1 1 add: string 2 fret 1 finger 1}\n{define: Bb7sus4 frets 1 3 1 1 fingers 1 3 1 1 add: string 2 fret 1 finger 1}\n{define: Bbm7 frets 1 1 1 1 fingers 1 1 1 1}\n{define: Bbdim frets 0 1 0 1 fingers 0 1 0 2}\n{define: Bbmaj7 frets 2 2 1 1 fingers 2 2 1 1}\n{define: Bb6 frets 0 2 1 1 fingers 0 2 1 1}\n{define: Bbm6 frets 0 1 1 1 fingers 0 1 1 1}\n{define: Bbsus2 frets 3 0 1 1 fingers 3 0 1 1}\n{define: Bbsus4 frets 3 3 1 1 fingers 3 3 1 1}\n{define: Bbaug frets 3 2 2 5 fingers 2 1 1 4 add: string 1 fret 2 finger 1 add: string 4 fret 2 finger 1}\n{define: Bb9 frets 1 2 1 3 fingers 2 1 4 3}\n{define: Bbmaj7 frets 2 2 1 1 fingers 2 2 1 1}\n{define: Bbm7-5 frets 1 1 0 1 fingers 1 2 0 3}\n{define: B frets 4 3 2 2 fingers 3 2 1 1}\n{define: Bm frets 4 2 2 2 fingers 3 1 1 1 add: string 1 fret 2 finger 1}\n{define: Bm6 frets 1 2 2 2 fingers 1 2 3 4}\n{define: B7 frets 2 3 2 2 fingers 1 2 1 1 add: string 2 fret 2 finger 1}\n{define: B7sus4 frets 2 4 2 2 fingers 1 3 1 1 add: string 2 fret 2 finger 1}\n{define: Bm7 frets 2 2 2 2 fingers 1 1 1 1}\n{define: Bdim frets 1 2 1 2 fingers 1 3 2 4}\n{define: Bmaj7 frets 3 3 2 2 fingers 2 2 1 1}\n{define: B6 frets 1 3 2 2 fingers 1 4 2 3}\n{define: Bsus2 frets 5 1 2 2 fingers 4 1 3 2}\n{define: Bsus4 frets 4 4 2 2 fingers 2 2 1 1}\n{define: Baug frets 0 3 3 2 fingers 0 2 2 1}\n{define: B9 frets 2 3 2 4}\n{define: C frets 0 0 0 3 fingers 0 0 0 3}\n{define: Cm frets 0 3 3 3 fingers 0 1 2 3}\n{define: C7 frets 0 0 0 1 fingers 0 0 0 1}\n{define: C7sus4 frets 0 0 1 1 fingers 0 0 1 1}\n{define: Cm7 frets 3 3 3 3 fingers 1 1 1 1}\n{define: Cdim frets 2 3 2 3 fingers 1 3 2 4}\n{define: Cmaj7 frets 0 0 0 2 fingers 0 0 0 1}\n{define: C6 frets 0 0 0 0}\n{define: Cm6 frets 0 3 5 5 fingers 0 1 3 1}\n{define: Csus2 frets 0 2 3 3 fingers 0 1 2 2}\n{define: Csus4 frets 0 0 1 3 fingers 0 0 1 3}\n{define: Caug frets 1 0 0 3 fingers 1 0 0 4}\n{define: C9 frets 0 2 0 1 fingers 0 2 0 1}\n{define: C# frets 1 1 1 4 fingers 1 1 1 4 add: string 4 fret 1 finger 1}\n{define: C#m frets 1 4 4 4 fingers 1 2 3 3}\n{define: C#7 frets 1 1 1 2 fingers 1 1 1 2 add: string 4 fret 1 finger 1}\n{define: C#7sus4 frets 1 1 2 2 fingers 1 1 2 3}\n{define: C#m7 frets 1 4 4 2 fingers 1 3 3 2}\n{define: C#dim frets 0 1 0 1 fingers 0 1 0 2}\n{define: C#maj7 frets 1 1 1 3 fingers 1 1 1 3 add: string 4 fret 1 finger 1}\n{define: C#6 frets 1 1 1 1 fingers 1 1 1 1}\n{define: C#m6 frets 1 1 0 1 fingers 1 2 0 3}\n{define: C#sus2 frets 1 3 4 4 fingers 1 2 3 3}\n{define: C#sus4 frets 1 1 2 4 fingers 1 1 2 4}\n{define: C#aug frets 2 1 1 4 fingers 2 1 1 4 add: string 1 fret 1 finger 1 add: string 4 fret 1 finger 1}\n{define: C#9 frets 1 3 1 2}\n{define: D frets 2 2 2 0 fingers 1 1 1 0}\n{define: Dm frets 2 2 1 0 fingers 2 2 1 0}\n{define: Dm6 frets 0 2 1 2 fingers 0 2 1 3}\n{define: D7 frets 2 2 2 3 fingers 1 1 1 2 add: string 4 fret 2 finger 1}\n{define: D7sus4 frets 2 2 3 3 fingers 1 1 2 3}\n{define: Dm7 frets 2 2 1 3 fingers 2 2 1 3}\n{define: Ddim frets 1 2 1 2 fingers 1 3 2 4}\n{define: Dmaj7 frets 2 2 2 4 fingers 1 1 1 2 add: string 4 fret 2 finger 1}\n{define: D6 frets 2 2 2 2 fingers 2 2 2 2}\n{define: Dsus2 frets 2 2 0 0 fingers 1 2 0 0}\n{define: Dsus4 frets 0 2 3 0 fingers 0 1 2 0}\n{define: Daug frets 3 2 2 5 fingers 2 1 1 4 add: string 1 fret 2 finger 1 add: string 4 fret 2 finger 1}\n{define: D9 frets 2 4 2 3}\n{define: Eb frets 0 3 3 1 fingers 0 2 2 1}\n{define: Ebm frets 3 3 2 1 fingers 3 3 2 1}\n{define: Eb7 frets 3 3 3 4 fingers 1 1 1 2 add: string 4 fret 3 finger 1}\n{define: Eb7sus4 frets 3 3 4 4 fingers 1 1 2 3}\n{define: Ebm7 frets 3 3 2 4 fingers 2 2 1 4}\n{define: Ebdim frets 2 3 2 3 fingers 1 3 2 4}\n{define: Ebmaj7 frets 3 3 3 5 fingers 1 1 1 2 add: string 4 fret 3 finger 1}\n{define: Eb6 frets 3 3 3 3 fingers 1 1 1 1}\n{define: Ebm6 frets 3 3 2 3 fingers 2 3 1 4}\n{define: Ebsus2 frets 3 3 1 1 fingers 2 2 1 1}\n{define: Ebsus4 frets 1 3 4 1 fingers 2 3 4 1}\n{define: Ebaug frets 0 3 3 2 fingers 0 2 2 1}\n{define: Eb9 frets 0 1 1 1}\n{define: E frets 4 4 4 2 fingers 2 3 4 1}\n{define: Em frets 0 4 3 2 fingers 0 3 2 1}\n{define: E7 frets 1 2 0 2 fingers 1 2 0 3}\n{define: E7sus4 frets 2 2 0 2 fingers 2 3 0 4}\n{define: Em6 frets 4 4 3 4 fingers 2 3 1 4}\n{define: Em7 frets 0 2 0 2 fingers 0 1 0 2}\n{define: Edim frets 0 1 0 1 fingers 0 1 0 2}\n{define: Emaj7 frets 1 3 0 2 fingers 1 3 0 2}\n{define: E6 frets 4 4 4 4 fingers 1 1 1 1}\n{define: Esus2 frets 4 4 2 2 fingers 3 3 1 1}\n{define: Esus4 frets 2 4 0 2 fingers 2 4 0 1}\n{define: Eaug frets 1 0 0 3 fingers 1 0 0 4}\n{define: E9 frets 1 2 2 2}\n{define: F frets 2 0 1 0 fingers 2 0 1 0}\n{define: Fm frets 1 0 1 3 fingers 1 0 2 4}\n{define: F7 frets 2 3 1 0 fingers 2 3 1 0}\n{define: F7sus4 frets 3 3 1 3 fingers 2 3 1 4}\n{define: Fm6 frets 1 2 1 3 fingers 1 2 1 3 add: string 2 fret 1 finger 1 add: string 4 fret 1 finger 1}\n{define: Fm7 frets 1 3 1 3 fingers 1 3 2 4}\n{define: Fdim frets 1 2 1 2 fingers 1 3 2 4}\n{define: Fmaj7 frets 5 5 0 0 fingers 1 2 0 0}\n{define: F6 frets 2 2 1 3 fingers 2 2 1 4}\n{define: Fsus2 frets 0 0 1 3 fingers 0 0 1 3}\n{define: Fsus4 frets 3 0 1 3 fingers 3 0 1 4}\n{define: F6sus2 frets 0 0 1 3 fingers 0 0 1 3}\n{define: F6sus4 frets 3 0 1 1 fingers 3 0 1 1}\n{define: F6aug frets 2 1 1 4 fingers 2 1 1 4 add: string 1 fret 1 finger 1 add: string 4 fret 1 finger 1}\n{define: F9 frets 2 3 3 3}\n{define: Faug frets 2 1 1 0 fingers 3 1 2 0}\n{define: F# frets 3 1 2 1 fingers 3 1 2 1 add: string 1 fret 1 finger 1 add: string 3 fret 1 finger 1}\n{define: F#m frets 2 1 2 0 fingers 2 1 3 0}\n{define: F#7 frets 3 4 2 1 fingers 3 4 2 1}\n{define: F#7sus4 frets 4 4 2 4 fingers 2 3 1 4}\n{define: F#m7 frets 2 4 2 4 fingers 1 3 2 4}\n{define: F#dim frets 2 3 2 3 fingers 1 3 2 4}\n{define: F#maj7 frets 3 5 2 4 fingers 2 4 1 3}\n{define: F#m6 frets 2 1 2 4 fingers 2 1 3 4}\n{define: F#6 frets 3 3 2 4 fingers 2 2 1 4}\n{define: F#sus2 frets 1 1 2 4 fingers 1 1 2 4}\n{define: F#sus4 frets 4 1 2 2 fingers 4 1 2 3}\n{define: F#aug frets 3 2 2 5 fingers 2 1 1 4 add: string 1 fret 2 finger 1 add: string 4 fret 2 finger 1}\n{define: F#9 frets 1 1 0 1}\n{define: G frets 0 2 3 2 fingers 0 1 3 2}\n{define: Gm frets 0 2 3 1 fingers 0 2 3 1}\n{define: Gm6 frets 0 2 0 1 fingers 0 2 0 1}\n{define: G7 frets 0 2 1 2 fingers 0 2 1 3}\n{define: G7sus4 frets 0 2 1 3 fingers 0 2 1 4}\n{define: Gm7 frets 0 2 1 1 fingers 0 2 1 1}\n{define: Gdim frets 0 1 0 1 fingers 0 1 0 2}\n{define: Gmaj7 frets 0 2 2 2 fingers 0 1 2 3}\n{define: G6 frets 0 2 0 2 fingers 0 1 0 2}\n{define: Gsus2 frets 0 2 3 0 fingers 0 1 2 0}\n{define: Gsus4 frets 0 2 3 3 fingers 0 1 2 3}\n{define: Gaug frets 0 3 3 2 fingers 0 2 2 1}\n{define: Gsus4 frets 0 2 3 3}\n{define: G9 frets 2 2 1 2}\n{define: G# frets 5 3 4 3 fingers 3 1 2 1 add: string 1 fret 3 finger 1 add: string 3 fret 3 finger 1}\n{define: G#m frets 1 3 4 2 fingers 1 3 4 2}\n{define: G#7 frets 1 3 2 3 fingers 1 3 2 4}\n{define: G#7sus4 frets 1 3 2 4 fingers 1 3 2 4}\n{define: G#m7 frets 1 3 2 2 fingers 1 4 2 3}\n{define: G#dim frets 1 2 1 2 fingers 1 3 2 4}\n{define: G#maj7 frets 1 3 3 3 fingers 1 2 2 3}\n{define: G#6 frets 1 3 1 3 fingers 1 3 2 4}\n{define: G#m6 frets 1 3 1 2 fingers 1 3 1 2 add: string 2 fret 1 finger 1 add: string 4 fret 1 finger 1}\n{define: G#sus2 frets 1 3 4 1 fingers 2 3 4 1}\n{define: G#sus4 frets 1 3 4 4 fingers 1 2 3 3}\n{define: G#aug frets 1 0 0 3 fingers 1 0 0 4}\n{define: G#9 frets 1 0 2 1 fingers 1 0 3 2}\n{define: C-F frets 2 0 1 3}\n{define: D/A frets 2 2 2 0}\n{define: Dm/C frets 2 2 1 3}\n{define: Fm7/C frets 1 3 1 3}\n{define: G/B frets 0 2 3 2}\n{define: G/F# frets 0 2 2 2}\n{define: G/F frets 0 2 1 2}\n{define: G7/B frets 0 2 1 2}";
ukeGeeks.canvasTools=function(){return{drawDot:function(a,c,b,d){a.beginPath();a.arc(c.x,c.y,b,0,2*Math.PI,!0);a.closePath();a.fillStyle=d;a.fill()},drawText:function(a,c,b,d,e,f){a.fillText&&(a.font=d,a.textAlign=f||"center",a.fillStyle=e,a.fillText(b,c.x,c.y))},addCanvas:function(a,c,b){var d=document.createElement("canvas");if(!d)return null;ukeGeeks.settings.environment.isIe&&(d=G_vmlCanvasManager.initElement(d));a.appendChild(d);d.width=c;d.height=b;return(a=d.getContext("2d"))?a:null}}}();
ukeGeeks.chordBrush=function(){return{init:function(){},plot:function(a,c,b,d,e){var f,g;if(a=ukeGeeks.canvasTools.addCanvas(a,b.width,b.height)){d||(d=ukeGeeks.settings.fonts);e||(e=ukeGeeks.settings.colors);var h=b.topLeftPos.x,k=b.topLeftPos.y,l=e.fretLines,n;f=b.lineWidth/2;g=ukeGeeks.settings.numFrets*b.fretSpace;var p=3*b.stringSpace;a.beginPath();for(n=1;3>n;n++){var m=h+n*b.stringSpace+f;a.moveTo(m,k+f);a.lineTo(m,k+g+f)}for(n=1;n<ukeGeeks.settings.numFrets;n++)m=k+n*b.fretSpace+f,a.moveTo(h+
f,m),a.lineTo(h+p+f,m);a.rect(h+f,k+f,p,g);a.strokeStyle=l;a.lineWidth=b.lineWidth;a.stroke();a.closePath();l=k+b.dotRadius;n=(b.fretSpace-2*b.dotRadius)/2;f=c.dots;g=-1;p=300;for(m=0;m<f.length;m++)f[m].fret>g&&(g=f[m].fret),f[m].fret<p&&(p=f[m].fret);f=300>p?p:0;g=0<g?g:0;p=5>=g?1:g-4;for(m=0;m<c.dots.length;m++){var q={x:h+c.dots[m].string*b.stringSpace,y:n+l+(c.dots[m].fret-p)*b.fretSpace};ukeGeeks.canvasTools.drawDot(a,q,b.dotRadius,e.dots);0<c.dots[m].finger&&b.showText&&4<b.dotRadius&&ukeGeeks.canvasTools.drawText(a,
{x:q.x,y:q.y+5},c.dots[m].finger,d.dot,e.dotText)}1!=p&&(l={x:0,y:k+0.96*b.fretSpace*(5-(g-f))},ukeGeeks.canvasTools.drawText(a,l,f,d.fret,e.fretText,"left"),1<g-f&&(l.y=k+4.8*b.fretSpace,ukeGeeks.canvasTools.drawText(a,l,g,d.fret,e.fretText,"left")));b.showText&&ukeGeeks.canvasTools.drawText(a,{x:h+1.5*b.stringSpace,y:k-5},c.name,d.text,e.text);c=c.muted;e=e.xStroke;d=b.topLeftPos.x+b.lineWidth/2;h=b.topLeftPos.y+b.lineWidth/4;for(k=0;k<c.length;k++)c[k]&&(l=a,n=d+k*b.stringSpace,f=h,g=b,p=e,n-=
g.xWidth/2,f-=g.xWidth/2,l.beginPath(),l.moveTo(n,f),l.lineTo(n+g.xWidth,f+g.xWidth),l.moveTo(n,f+g.xWidth),l.lineTo(n+g.xWidth,f),l.strokeStyle=p,l.lineWidth=g.xStroke,l.stroke(),l.closePath())}}}};ukeGeeks.chordParser=function(){};
ukeGeeks.chordParser.prototype={chords:[],init:function(){},parse:function(a){this.chords=this._findChords(a);a=this._encloseChords(a,this.chords);return a=this._packChords(a)},getChords:function(){return this.chords},_findChords:function(a){var c,b=a.match(/\[(.+?)]/img);if(!b)return[];var d=[],e;for(a=0;a<b.length;a++){e=!1;for(c=0;c<d.length;c++)if(d[c]==b[a]){e=!0;break}e||d.push(b[a])}for(c in d)d[c]=d[c].replace("[","").replace("]","");return d},_encloseChords:function(a,c){var b=ukeGeeks.settings.opts.retainBrackets?
"[":" ",d=ukeGeeks.settings.opts.retainBrackets?"]":" ",e;for(e in c){do;while(a.length!=(a=a.replace("["+c[e]+"]",'<code data-chordName="'+c[e]+'"><strong>'+b+"<em>"+c[e]+"</em>"+d+"</strong></code>")).length)}return a},_packChords:function(a){var c;if(ukeGeeks.settings.inlineDiagrams)return c=/(<\/strong><\/code>)[ \t]*(<code data-chordName="[^"]*"><strong>)/ig,a.replace(c,'$1<span class="ugsInlineSpacer">&nbsp;</span>$2');c=/<\/strong><\/code>[ \t]*<code data-chordName="[^"]*"><strong>/ig;return a.replace(c,
" ")}};ukeGeeks.cpmParser=function(){};
ukeGeeks.cpmParser.prototype={runaway:30,columnCount:1,hasChords:!1,init:function(){},parse:function(a){var c=new ukeGeeks.data.song;a=this._stripHtml(a);a=this._domParse(a);a=this._parseInstr(a);a=this._parseSimpleInstr(a);a=this._markChordLines(a);c.body=this._export(a);1<this.columnCount&&(c.body='<div class="'+this.classNames.ColumnWrap+" "+this.classNames.ColumnCount+this.columnCount+'"><div class="'+this.classNames.Column+'">'+c.body+"</div></div>");c.hasChords=this.hasChords;var b;b=this._getInfo(a,
this.blockTypeEnum.Title);0<b.length&&(c.title=b[0]);b=this._getInfo(a,this.blockTypeEnum.Artist);0<b.length&&(c.artist=b[0]);b=this._getInfo(a,this.blockTypeEnum.Subtitle);0<b.length&&(c.st=b[0]);1<b.length&&(c.st2=b[1]);b=this._getInfo(a,this.blockTypeEnum.Album);0<b.length&&(c.album=b[0]);b=this._getInfo(a,this.blockTypeEnum.UkeGeeksMeta);0<b.length&&(c.ugsMeta=b);b=this._getInfo(a,this.blockTypeEnum.ChordDefinition);if(0<b.length)for(var d in b)c.defs.push(ukeGeeks.chordImport.runLine("{define: "+
b[d]+"}"));return c},regEx:{blocks:/\s*{\s*(start_of_tab|sot|start_of_chorus|soc|end_of_tab|eot|end_of_chorus|eoc)\s*}\s*/im,tabBlock:/\s*{\s*(start_of_tab|sot)\s*}\s*/im,chorusBlock:/\s*{\s*(start_of_chorus|soc)\s*}\s*/im},classNames:{Comment:"ugsComment",Tabs:"ugsTabs",Chorus:"ugsChorus",PreChords:"ugsChords",PrePlain:"ugsPlain",NoLyrics:"ugsNoLyrics",ColumnWrap:"ugsWrap",ColumnCount:"ugsColumnCount",Column:"ugsColumn",NewPage:"ugsNewPage"},blockTypeEnum:{TextBlock:1,ChorusBlock:2,TabBlock:3,Comment:101,
Title:102,Subtitle:103,Album:104,ChordDefinition:105,UkeGeeksMeta:106,ColumnBreak:107,Artist:108,NewPage:109,ChordText:201,PlainText:202,ChordOnlyText:203,Undefined:666},_getBlockType:function(a){return this.regEx.chorusBlock.test(a)?this.blockTypeEnum.ChorusBlock:this.regEx.tabBlock.test(a)?this.blockTypeEnum.TabBlock:this.blockTypeEnum.TextBlock},_export:function(a){for(var c="",b=0;b<a.length;b++)if(a[b].type==this.blockTypeEnum.Comment)c+='<h6 class="'+this.classNames.Comment+'">'+a[b].lines[0]+
"</h6>\n";else if(a[b].type==this.blockTypeEnum.NewPage)c+='<hr class="'+this.classNames.NewPage+'" />\n';else if(a[b].type==this.blockTypeEnum.ChordText||a[b].type==this.blockTypeEnum.PlainText||a[b].type==this.blockTypeEnum.ChordOnlyText){if(!(1>a[b].lines[0].length)){var d=a[b].type==this.blockTypeEnum.PlainText?this.classNames.PrePlain:this.classNames.PreChords;a[b].type==this.blockTypeEnum.ChordOnlyText&&(d+=" "+this.classNames.NoLyrics);var e=a[b].type,f=0<=b-1?a[b-1].type:this.blockTypeEnum.Undefined,
g=b+1<a.length?g=a[b+1].type:this.blockTypeEnum.Undefined,c=c+(f!=e?'<pre class="'+d+'">':"\n"),c=c+a[b].lines[0],c=c+(g!=e?"</pre>\n":"")}}else if(a[b].type==this.blockTypeEnum.ChorusBlock)c+='<div class="'+this.classNames.Chorus+'">\n',c+=this._export(a[b].lines),c+="</div>\n";else if(a[b].type==this.blockTypeEnum.TabBlock){var c=c+('<pre class="'+this.classNames.Tabs+'">'),h;for(h in a[b].lines)c+=a[b].lines[h]+"\n";c+="</pre>\n"}else a[b].type==this.blockTypeEnum.TextBlock?c+=this._export(a[b].lines):
a[b].type==this.blockTypeEnum.ColumnBreak&&(c+='</div><div class="'+this.classNames.Column+'">');return c},_echo:function(a){for(var c in a){console.log(">> "+c+". "+a[c].type+" node, "+a[c].lines.length+" lines");for(var b in a[c].lines)console.log(a[c].lines[b])}},_domParse:function(a){a=a.split("\n");var c=[],b=null,d,e;for(e in a)0<a[e].length&&"#"==a[e][0]||((d=this.regEx.blocks.test(a[e]))||null===b?(null!==b&&c.push(b),b={type:this._getBlockType(a[e]),lines:[]},d||b.lines.push(a[e])):(d=ukeGeeks.toolsLite.trim(a[e]),
0<d.length&&b.lines.push(d)));0<b.lines.length&&c.push(b);return c},_parseInstr:function(a){var c=/\{[^}]+?:.*?\}/im,b=/\{.+?:(.*)\}/gi,d=/\{(.+?)\s*:.*\}/gi,e;for(e in a)for(var f in a[e].lines)if(c.test(a[e].lines[f])){var g=a[e].lines[f].replace(b,"$1"),h=a[e].lines[f].replace(d,"$1").toLowerCase(),h=h.replace(/\r/,""),k={type:"",lines:[]};switch(h){case "title":case "t":k.type=this.blockTypeEnum.Title;break;case "artist":k.type=this.blockTypeEnum.Artist;break;case "subtitle":case "st":k.type=
this.blockTypeEnum.Subtitle;break;case "album":k.type=this.blockTypeEnum.Album;break;case "comment":case "c":k.type=this.blockTypeEnum.Comment;break;case "define":k.type=this.blockTypeEnum.ChordDefinition;break;case "ukegeeks-meta":k.type=this.blockTypeEnum.UkeGeeksMeta;break;default:k.type="Undefined-"+h}k.lines[0]=ukeGeeks.toolsLite.trim(g);a[e].lines[f]=k}return a},_parseSimpleInstr:function(a){var c=/\s*{\s*(column_break|colb|np|new_page)\s*}\s*/im,b;for(b in a)for(var d in a[b].lines)if(c.test(a[b].lines[d]))switch(a[b].lines[d].replace(c,
"$1").toLowerCase()){case "column_break":case "colb":this.columnCount++;a[b].lines[d]={type:this.blockTypeEnum.ColumnBreak,lines:[]};break;case "new_page":case "np":a[b].lines[d]={type:this.blockTypeEnum.NewPage,lines:[]}}return a},_markChordLines:function(a){var c=/\[(.+?)]/i,b=/\[(.+?)]/img,d,e,f,g;for(g in a)if(a[g].type==this.blockTypeEnum.TextBlock||a[g].type==this.blockTypeEnum.ChorusBlock)for(var h in a[g].lines)f=a[g].lines[h],"string"==typeof f&&(d=c.test(f),this.hasChords=this.hasChords||
d,e=d&&1>ukeGeeks.toolsLite.trim(f.replace(b,"")).length,a[g].lines[h]={type:e?this.blockTypeEnum.ChordOnlyText:d?this.blockTypeEnum.ChordText:this.blockTypeEnum.PlainText,lines:[f]});return a},_getInfo:function(a,c){var b=[],d;for(d in a)if(a[d].type==c)b.push(a[d].lines[0]);else if(a[d].type==this.blockTypeEnum.TextBlock)for(var e in a[d].lines)a[d].lines[e].type==c&&b.push(a[d].lines[e].lines[0]);return b},_stripHtml:function(a){return a.replace(/<\/?pre>/img,"").replace(/\x3c!--(.|\n)*?--\x3e/gm,
"")}};
ukeGeeks.chordPainter=function(){var a={},c=null,b=[],d=null;a.init=function(a){c=new ukeGeeks.chordBrush;c.init();d=a};var e=[],f=/^(n.?\/?c.?|tacet)$/i;a.show=function(a){d.diagrams.innerHTML="";b=[];e=[];for(var h=0;h<a.length;h++)if(!f.test(a[h])){var k;if(k=ukeGeeks.settings.opts.ignoreCommonChords)a:{for(k=0;k<ukeGeeks.settings.commonChords.length;k++)if(a[h]==ukeGeeks.settings.commonChords[k]){k=!0;break a}k=!1}k?e.push(a[h]):(k=ukeGeeks.definitions.get(a[h]))?c.plot(d.diagrams,k,ukeGeeks.settings.fretBox):b.push(a[h])}};
a.showInline=function(a){var b=d.text.getElementsByTagName("code");if(!(1>b.length))for(var e=0;e<a.length;e++){var f=ukeGeeks.definitions.get(a[e]);if(f)for(var n=0;n<b.length;n++)b[n].getAttribute("data-chordName")==f.name&&c.plot(b[n],f,ukeGeeks.settings.inlineFretBox,ukeGeeks.settings.inlineFretBox.fonts)}};a.getErrors=function(){return b};a.getIgnoredChords=function(){return e};return a};ukeGeeks.tabs=function(){};
ukeGeeks.tabs.prototype={_numStrings:4,_lastStringName:"G",init:function(){},replace:function(a){a=a.getElementsByTagName("pre");for(var c in a)if("ugsTabs"==a[c].className){var b=a[c].innerHTML;a[c].innerHTML="";this.loadBlocks(b,a[c])}},loadBlocks:function(a,c){var b=a.split("\n"),d=[],e;for(e in b){var f=ukeGeeks.toolsLite.trim(b[e]);0<f.length&&d.push(f);d.length==this._numStrings&&(this.redraw(d,c),d=[])}},redraw:function(a,c){a="string"==typeof a?a.split("\n"):a;if(!(a.length<this._numStrings)){var b=
this._readTabs(a),d=b.hasLabels?ukeGeeks.settings.tabs.labelWidth:0,e=b.tabs,f=(this._numStrings-1)*ukeGeeks.settings.tabs.lineSpacing+2*ukeGeeks.settings.tabs.dotRadius+ukeGeeks.settings.tabs.bottomPadding;c="string"==typeof c?document.getElementById(c):c;var f=ukeGeeks.canvasTools.addCanvas(c,this._getWidth(e,d,!1),f),g={x:ukeGeeks.settings.tabs.dotRadius+d,y:1+ukeGeeks.settings.tabs.dotRadius};this._drawStaff(f,g,this._getWidth(e,d,!0),ukeGeeks.settings.tabs);this._drawNotes(f,g,e,ukeGeeks.settings.tabs);
b.hasLabels&&this._drawLabels(f,g,ukeGeeks.settings.tabs)}},_readTabs:function(a){var c=a[this._numStrings-1][0]==this._lastStringName;c&&this._stripStringLabels(a);var b=this._getFretNumbers(a),d=this._getSymbols(a);a=this._getMinLineLength(a);var e=this._getGuideLine(d,a);return{tabs:this._getPackedLines(b,d,e,a),hasLabels:c}},_getWidth:function(a,c,b){if(!b)return ukeGeeks.settings.tabs.noteSpacing*a[0].length+c+ukeGeeks.settings.tabs.dotRadius;b=a[0].length;var d=ukeGeeks.settings.tabs.dotRadius;
"|"==a[0][b-1]&&(b-=1,d=0);return ukeGeeks.settings.tabs.noteSpacing*b+c+d},_stripStringLabels:function(a){for(var c=0;c<this._numStrings;c++)a[c]=a[c].substr(1)},_getFretNumbers:function(a){for(var c=/([0-9]+)/g,b=[],d=0;d<this._numStrings;d++)b[d]=a[d].match(c);return b},_getSymbols:function(a){for(var c=/([0-9]{2})/g,b=/([0-9])/g,d=[],e=0;e<this._numStrings;e++)d[e]=a[e].replace(c,"-*"),d[e]=d[e].replace(b,"*");return d},_getMinLineLength:function(a){for(var c=1E4,b=0;b<this._numStrings;b++)c=
a[b].length<c?a[b].length:c;return c},_getGuideLine:function(a,c){for(var b="",d=0;d<c;d++)b="|"==a[0][d]?b+"|":b+("*"==a[0][d]||"*"==a[1][d]||"*"==a[2][d]||"*"==a[3][d]?"*":"-");for(var d=/--/g,b=b.replace(d,"- "),d=/ -/g,e=b;;){b=b.replace(d,"  ");if(b==e)break;e=b}return b},_getPackedLines:function(a,c,b,d){for(var e=[[],[],[],[]],f="",g=0;g<this._numStrings;g++)for(var h=0,k=0,l=0;l<d;l++)" "!=b[l]&&("*"==c[g][l]?(f=a[g][k],k++):f="|"==b[l]?"|":"-",e[g][h]=f,h++);return e},_drawStaff:function(a,
c,b,d){var e=d.lineWidth/2,f=c.x+e;c=c.y+e;a.beginPath();for(e=0;e<this._numStrings;e++)a.moveTo(f,c),a.lineTo(f+b,c),c+=d.lineSpacing;a.strokeStyle=d.lineColor;a.lineWidth=d.lineWidth;a.stroke();a.closePath()},_drawNotes:function(a,c,b,d){var e,f={x:0,y:c.y},g;for(g in b){if(3<g)break;f.x=c.x;for(var h in b[g])e=b[g][h],"|"==e?(e=parseInt(h,10),this._drawMeasure(a,{x:f.x,y:c.y},d,e+1<b[g].length-1&&"|"==b[g][e+1]||e==b[g].length-1&&"|"==b[g][e-1])):isNaN(e)||(ukeGeeks.canvasTools.drawDot(a,f,d.dotRadius,
d.dotColor),ukeGeeks.canvasTools.drawText(a,{x:f.x,y:f.y+0.5*d.dotRadius},e,d.textFont,d.textColor)),f.x+=d.noteSpacing;f.y+=d.lineSpacing}},_drawMeasure:function(a,c,b,d){var e=b.lineWidth/2;a.beginPath();a.moveTo(c.x+e,c.y);a.lineTo(c.x+e,c.y+(this._numStrings-1)*b.lineSpacing);a.strokeStyle=b.lineColor;a.lineWidth=(d?4.5:1)*b.lineWidth;a.stroke();a.closePath()},_drawLabels:function(a,c,b){for(var d=ukeGeeks.settings.tuning.slice(0).reverse(),e=0;e<this._numStrings;e++)ukeGeeks.canvasTools.drawText(a,
{x:1,y:c.y+(e+0.3)*b.lineSpacing},d[e],b.labelFont,b.lineColor,"left")}};
ukeGeeks.overlapFixer=function(){var a={},c=function(a){for(var c=a,f={top:0,left:0,right:0,width:0};c&&!isNaN(c.offsetLeft)&&!isNaN(c.offsetTop);)f.left+=c.offsetLeft-c.scrollLeft,f.top+=c.offsetTop-c.scrollTop,c=c.offsetParent;f.width=b(a);if(a=a.getElementsByTagName("em")[0])a=b(a),a>f.width&&(f.width=a+2);f.right=f.left+f.width;return f},b=function(a){return"undefined"!==typeof a.clip?a.clip.width:a.style.pixelWidth?a.style.pixelWidth:a.offsetWidth};a.Fix=function(a){var b=a.getElementsByTagName("code");
for(a=0;a<b.length;a++)b[a].style.paddingRight="0px";for(a=0;a<b.length-1;a++){var f=b[a],g=b[a+1],h=f.getElementsByTagName("strong")[0],g=g.getElementsByTagName("strong")[0];h&&g&&(h=c(h),g=c(g),h.top!=g.top||g.left>h.right||g.right<h.left?0:g.left>h.left&&g.left<h.right||g.right>h.left&&g.right<h.right)&&(h=h.right-g.left+1,f.style.paddingRight=(1>h?1:h)+"px")}};return a}();
ukeGeeks.scriptasaurus=function(){var a=[],c=function(b){var c=new ukeGeeks.cpmParser;c.init();c=c.parse(b.text.innerHTML);ukeGeeks.definitions.replace(c.defs);var e=new ukeGeeks.chordParser;e.init();b.text.innerHTML=e.parse(c.body);c.chords=e.getChords();e=new ukeGeeks.chordPainter;e.init(b);e.show(c.chords);ukeGeeks.settings.inlineDiagrams&&(ukeGeeks.toolsLite.addClass(b.wrap,"ugsInlineDiagrams"),e.showInline(c.chords));var f=new ukeGeeks.tabs;f.init();f.replace(b.text);a.push(e.getErrors());(e=
b.wrap)&&(c.hasChords?ukeGeeks.toolsLite.removeClass(e,"ugsNoChords"):ukeGeeks.toolsLite.addClass(e,"ugsNoChords"));ukeGeeks.settings.opts.autoFixOverlaps&&ukeGeeks.overlapFixer.Fix(b.text);return c};return{init:function(a){var c=ukeGeeks.definitions;ukeGeeks.settings.environment.isIe=a;c.addInstrument(c.sopranoUkuleleGcea);c.useInstrument(c.instrument.sopranoUke);ukeGeeks.settings.defaultInstrument!=c.instrument.sopranoUke&&c.useInstrument(ukeGeeks.settings.defaultInstrument)},run:function(){var b=
new ukeGeeks.data.htmlHandles(document.getElementById(ukeGeeks.settings.ids.container),document.getElementById(ukeGeeks.settings.ids.canvas),document.getElementById(ukeGeeks.settings.ids.songText));if(!(b&&b.diagrams&&b.text&&b.wrap))return null;a=[];b=c(b);var d=a[0];if(!(1>d.length)){for(var e="",f=0;f<d.length;f++)e+=0<e.length?", ":"",e+=d[f];alert("Forgive me, but I don't know the following chords: "+e)}return b},runByClasses:function(){for(var a=[],d=ukeGeeks.toolsLite.getElementsByClass(ukeGeeks.settings.wrapClasses.wrap),
e=0;e<d.length;e++){var f;f=d[e];var g=ukeGeeks.toolsLite.getElementsByClass(ukeGeeks.settings.wrapClasses.diagrams,f),h=ukeGeeks.toolsLite.getElementsByClass(ukeGeeks.settings.wrapClasses.text,f);f=void 0===g||1>g.length||void 0===h||1>h.length?null:new ukeGeeks.data.htmlHandles(f,g[0],h[0]);null!==f&&a.push(c(f))}return a},setTuningOffset:function(a){ukeGeeks.definitions.useInstrument(a)}}}();